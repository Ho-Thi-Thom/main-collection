(()=>{function N(){let t=document.querySelector(".jsCartPopup"),e=document.querySelector(".jsCartPopup .popup__header-close");e&&e.addEventListener("click",()=>{t.classList.remove("active"),document.querySelector("#bg-color").classList.remove("body-overlay")})}N();async function O(t){try{return await(await fetch(window.location.pathname+`?section_id=${t}`)).text()}catch(e){return e}}async function w(){let e=document.querySelector(".jsCartPopup").dataset.sectionId,n=await O(e),o=document.createElement("div");o.innerHTML=n;let u=o.querySelector(".jsCartPopup").querySelectorAll(".jsPopupUpdate");return document.querySelectorAll(".jsCartPopup .jsPopupUpdate").forEach((l,i)=>{l.parentNode.replaceChild(u[i],l)}),!0}function x(t="",e={},n){let o=new URLSearchParams(e);return n&&typeof n=="function"&&n(o),t?t+"?"+o.toString():window.location.pathname+"?"+o.toString()}function E(t,e,n=!0){t&&(t(),n&&document.addEventListener("shopify:section:load",o=>{o.detail.sectionId===e&&t()}))}function v(t,e){var n=null;return function(){clearTimeout(n);var o=arguments,s=this;n=setTimeout(function(){t.apply(s,o)},e)}}function q(t,e,n,o=!1){let s=document.createElement("div");s.innerHTML=t;let u=document.querySelector(`li.cart__item.jsLineItem[data-line-index="${e}"]`);if(n)o||u.remove();else{let i=s.querySelector(`li.cart__item.jsLineItem[data-line-index="${e}"]`),m=u.querySelectorAll(".jsLineUpdate"),a=i.querySelectorAll(".jsLineUpdate");m.forEach((r,c)=>{r.parentNode.replaceChild(a[c],r)})}let p=document.querySelectorAll(".js-cart-update"),l=s.querySelectorAll(".js-cart-update");p.forEach((i,m)=>{i.parentNode.replaceChild(l[m],i)})}function P(t){fetch("/cart/update.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({note:t})})}async function C(t){let{variantId:e,newQuantity:n,sectionId:o}=t;return await(await fetch("/cart/change.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,quantity:n,sections:o})})).json()}function I(t,e,n){let o=document.querySelector(`.cart__item.jsLineItem[data-line-index="${n}"] .add__qlt`);switch(e){case"add":+t.value==+t.max&&(o.disabled=!0);break;case"remove":o.disabled=!1;break;default:break}}function b(){document.querySelectorAll(".jsLineItem").forEach(e=>{let n=e.querySelector(".quantity__input"),o=parseInt(n.getAttribute("max")),s=e.querySelector(".add__qlt");n.value===o.toString()?s.disabled=!0:s.disabled=!1})}async function k(){try{return(await(await fetch(window.Shopify.routes.root+"cart.js")).json()).item_count}catch(t){return t}}async function A(){try{let t=await k(),e=document.querySelector(".jsCountItemCart");return e.textContent=t,t}catch(t){console.error(t)}}var g=document.querySelector(".cart-section-wrapper")?.dataset.sectionId;g&&E(M,g);function M(t=!0,e=!1){let n=document.querySelectorAll(".cart__item .remove__qlt"),o=document.querySelectorAll(".cart__item .add__qlt"),s=document.querySelectorAll(".btn-remove");b(),u(s),u([...o,...n]);function u(a=[]){!a||a.length===0||a.forEach(r=>{let c=null;r.addEventListener("click",f=>{let y=f.target,h=y.closest(".cart__item.jsLineItem").dataset.lineIndex,d=document.querySelector(`.cart__item.jsLineItem[data-line-index="${h}"] .quantity__input`);y.classList.contains("add__qlt")&&(d.stepUp(),I(d,"add",h)),y.classList.contains("remove__qlt")&&(d.stepDown(),I(d,"remove",h));let S=d.value,L=y.classList.contains("btn-remove");L&&(S=0),c&&clearTimeout(c),c=setTimeout(async()=>{d.value;let _=d.getAttribute("data-sections"),T={variantId:d.getAttribute("data-key"),newQuantity:S,sectionId:_};try{let U=(await C(T)).sections[_];await A()?q(U,h,checkRemove=L):e?w():location.reload()}catch(j){console.log("Error",j)}},1e3)})})}document.querySelectorAll(".cart__item .quantity__input").forEach(function(a){a.addEventListener("keydown",function(r){r.key==="Enter"&&r.preventDefault()}),a.addEventListener("input",v(async r=>{let c=r.target.closest(".cart__item.jsLineItem").dataset.lineIndex,f=r.target,h={variantId:f.getAttribute("data-key"),newQuantity:f.value,sectionId:g};try{let S=(await C(h)).sections[g];q(S,c)}catch(d){}},2e3))}),document.querySelectorAll(".accordion-initialized").forEach(function(a){let r=a.querySelector(".accordion-trigger"),c=a.querySelector(".cart__form-note");r.addEventListener("click",function(){c.classList.toggle("active")})});let i=document.getElementById("cart-note"),m=v(()=>P(i.value),500);i.addEventListener("input",m),t&&R()}function R(){let t=document.getElementsByName("shipping_address[country]")[0];t.addEventListener("change",function(s){let p=t.options[t.selectedIndex].getAttribute("data-provinces"),l=document.querySelector(".jsProvince"),i=l.querySelector("[name='shipping_address[province]']");JSON.parse(p).length?(JSON.parse(p).forEach(([m,a])=>{let r=document.createElement("option");r.value=m,r.text=a,i.appendChild(r)}),l.style.display="block"):l.style.display="none"});let n=document.querySelector(".jsShippingRates").dataset.url;document.querySelector(".shipping-form").addEventListener("submit",s=>{s.preventDefault();let u=Object.fromEntries(new FormData(s.target).entries()),p=document.querySelector(".jsButtonShipping");p.classList.add("loading");let l=x(n,u),i=document.querySelector(".js-shipping-result"),m=document.querySelector("template").content.firstElementChild,a=document.createElement("div");i.innerHTML="",fetch(l).then(r=>r.json()).then(r=>{let c=r.shipping_rates,f=theme.strings.notFoundShippingRate;c&&c.length>1?f=theme.strings.manyShippingRate.replace("{{ number }}",c.length):c&&c.length===1&&(f=theme.strings.oneShippingRate),document.querySelector(".js-response-title").innerHTML=f,c&&c.forEach(y=>{a.innerHTML=m.outerHTML,a.querySelector(".shipping-name").innerHTML=y.name,a.querySelector(".shipping-cost").textContent=y.price,i.insertAdjacentHTML("beforeend",a.innerHTML)}),p.classList.remove("loading")})})}})();
