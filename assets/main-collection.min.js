(()=>{var M=document.querySelector("#infinity_point"),I=document.querySelector("#sort_by"),v=document.querySelector("#show"),L=document.querySelectorAll('input[type="checkbox"]'),C=document.querySelectorAll('input[type="number"]'),O=document.querySelectorAll(".paginate_link[data-url]"),z=document.querySelector(".collection__toolbar-filter-showing"),{loading:$,createUrl:q,hiddenLoading:H,getApi:h,appendProduct:B,setProduct:S,updateCount:A,updateShowing:m,updatePointInfinity:P,updatePaginate:E,createUrlFilter:U}=G();N(M);function N(t){if(t){let l=new IntersectionObserver(i=>{i.forEach(n=>{if(n.isIntersecting){let c=function(f){f.set("section_id",a)};var u=c;let r=n.target,o=r.dataset.url,a=r.dataset.sectionId,g=o?q(c,o.split("?")[1]):null;if(g==null){l.disconnect();return}$(r),h(g).then(f=>{let w=f.getElementPointInfinity();B(f.getElementProduct()),P(w),m(f.getElementShowing())}).finally(()=>{H(r)})}})});l.observe(t)}}I&&I.addEventListener("change",t=>{let l=t.target.value,i=t.target.dataset.sectionId;function n(r){r.set("sort_by",l)}let u=q(n,window.location.href.split("?")[1]);history.pushState(null,null,u),u+=u.includes("?")?"&":"?",u+=`section_id=${i}`,h(u).then(r=>{S(r.getElementProduct()),P(r.getElementPointInfinity()),m(r.getElementShowing())})});v&&v.addEventListener("change",t=>{let l=t.target.value,i=t.target.dataset.sectionId,n=`${window.Shopify.routes.root}cart/update.js`,u={attributes:{items_per_page:l},sections:[i]},r={method:"POST",body:JSON.stringify(u),headers:{"Content-Type":"application/json"}};function o(a){return a.json().then(c=>c.sections[i])}h(n,r,o).then(a=>{S(a.getElementProduct()),P(a.getElementPointInfinity()),E(a.getPaginate()),m(a.getElementShowing())})});L&&L.forEach(t=>{t.addEventListener("change",l=>{let i=l.target.value,n=l.target.name;function u(o){l.target.checked?(o[n]||(o[n]=[]),o[n].push(i)):o[n]&&(o[n]=o[n].filter(a=>a!==i))}let r=U(u,window.location.search);history.pushState(null,null,r),h(r).then(o=>{S(o.getElementProduct()),A(o.getProductCount()),E(o.getPaginate()),m(o.getElementShowing()),P(o.getElementPointInfinity())})})});if(C){let t={"filter.v.price.gte":0,"filter.v.price.lte":Number.MAX_SAFE_INTEGER};C.forEach(l=>{l.addEventListener("change",i=>{let n=i.target.value,u=i.target.name,r=i.target.dataset.max;t["filter.v.price.lte"]=r,t[u]=n;function o(c){for(let g in t)c[g]=[],c[g].push(t[g])}let a=U(o,window.location.search);history.pushState(null,null,a),h(a).then(c=>{S(c.getElementProduct()),A(c.getProductCount()),P(c.getElementPointInfinity()),E(c.getPaginate()),m(c.getElementShowing())})})})}F(O);function F(t){t&&t.forEach(l=>{l.addEventListener("click",i=>{let n=i.target,u=n.dataset.url,r=n.dataset.sectionId;function o(c){c.set("section_id",r)}let a=q(o,u.split("?")[1]);h(a).then(c=>{S(c.getElementProduct()),E(c.getPaginate()),m(c.getElementShowing())})})})}function G(){let t=document.querySelector("#collection__products"),l=document.querySelector(".product_count"),i=document.querySelector(".collection__toolbar-filter-showing"),n=document.querySelector("#infinity_point"),u=document.querySelector(".paginate");function r(e){e.innerHTML="Loading..."}function o(e){e.innerHTML=""}function a(e,s){let p=new URLSearchParams(s);return e(p),window.location.pathname+"?"+p.toString()}function c(e,s){let p=new URLSearchParams(s),d={};p.forEach(function(_,y){d[y]||(d[y]=[]),d[y].push(_)}),e(d);let b=new URLSearchParams;return Object.keys(d).forEach(_=>{d[_].forEach(y=>{b.append(_,y)})}),`${window.location.pathname}?${b.toString()}`}function g(e,s,p){return fetch(e,s).then(d=>p?.(d)??d.text()).then(d=>k(d))}function f(e){e.querySelectorAll("#collection__products > *")?.forEach(s=>{t?.appendChild(s)})}function w(e){t&&(t.parentNode.replaceChild(e,t),t=document.querySelector("#collection__products"))}function T(e){l&&(l.parentNode.replaceChild(e,l),l=document.querySelector(".product_count"))}function x(e){console.log(i,e),i&&(i.parentNode.replaceChild(e,i),i=document.querySelector(".collection__toolbar-filter-showing"))}function R(e){n&&(n.parentNode.replaceChild(e,n),n=document.querySelector("#infinity_point"),N(document.querySelector("#infinity_point")))}function j(e){u&&(u.parentNode.replaceChild(e,u),u=document.querySelector(".paginate"),F(document.querySelectorAll(".paginate_link[data-url]")))}function k(e){let s=document.createElement("div");return s.innerHTML=e,{getElementProduct(){return s.querySelector("#collection__products")},getProductCount(){return s.querySelector(".product_count")},getElementPointInfinity(){return s.querySelector("#infinity_point")},getPaginate(){return s.querySelector(".paginate")},getElementShowing(){return s.querySelector(".collection__toolbar-filter-showing")}}}return{loading:r,hiddenLoading:o,getApi:g,appendProduct:f,setProduct:w,updateCount:T,updateShowing:x,updatePointInfinity:R,createUrl:a,updatePaginate:j,createUrlFilter:c}}})();
